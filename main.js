!function(){"use strict";const e=document.querySelector(".profile-info__edit-button"),t=(document.querySelector(".profile-info__name"),document.querySelector(".profile-info__subtitle"),document.querySelector(".modal__name"),document.querySelector(".modal__description"),document.querySelector(".add-button")),s=document.querySelector(".profile__avatar-hover-button"),r={cardSection:".gallery__cards",cardTemplate:".card-template",previewPopup:".image-pop-up",profileModal:".profile-modal",addCardModal:".new-item-modal",changeAvatarForm:".change-avatar-form"},i={formInputTypeErrorClass:"form__input_type_error",formInputErrorActiveClass:"form__input-error_active",formInputSelector:".form__input",formSubmitSelector:".form__submit",formSubmitInactiveClass:"form__submit_inactive",formSelector:".form"};class n{constructor(e,t,s,r,i,n,o){this._name=e.name,this._link=e.link,this._id=e._id,this._likes=e.likes,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteClick=i,this._handleLikeClick=n,this._loadingLikeCheck=o,this._userId=t,this._userCardOwnerId=e.owner._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}setCardEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this._id)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteClick(this._id)}))}_handleImageClick(){this._handleCardClick(this._name,this._link)}deleteCard(){this._cardElement.remove(),this._cardElement=null}updateLikes(e){this._likes=e,this.renderLikes()}renderLikes(){this._cardLikes.textContent=this._likes.length,this.isLiked()?this._likeButton.classList.add("card__like-button-active"):this._likeButton.classList.remove("card__like-button-active")}isLiked(){return this._likes.some((e=>e._id===this._userId))}getView(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__title").textContent=this._name,this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._imageModal=this._cardElement.querySelector(".image-pop-up"),this._cardLikes=this._cardElement.querySelector(".card__counter"),this.renderLikes(),this._userId!=this._userCardOwnerId&&this._deleteButton.remove(),this.setCardEventListeners(),this._cardElement}}var o=class{constructor(e,t){this._inputSelector=e.formInputSelector,this._submitButtonSelector=e.formSubmitSelector,this._inactiveButtonClass=e.formSubmitInactiveClass,this._inputErrorClass=e.formInputTypeErrorClass,this._errorClass=e.formInputErrorActiveClass,this._form=t}_setEventListeners(){this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);console.log(e),console.log(e.id),console.log(this._form),e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)):(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass))}_hasInvalidInput(){return this._inputElements.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputElements.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}};class a{constructor(e,t){let{renderer:s,items:r}=e;this._renderer=s,this._initialArray=r,this._container=document.querySelector(t)}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class l{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscUp=this._handleEscUp.bind(this)}open(){this._popupElement.classList.add("modal__open"),document.addEventListener("keyup",this._handleEscUp)}close(){this._popupElement.classList.remove("modal__open"),document.removeEventListener("keyup",this._handleEscUp)}_handleEscUp(e){e.preventDefault(),"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("close-icon"))&&this.close()}))}}class c extends l{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".form"),this._handleFormSubmit=s,this._inputList=this._popupForm.querySelectorAll(".form__input"),this._saveButton=this._popupForm.querySelector(".form__submit")}renderLoading(e,t){this._saveButton.textContent=e?"Saving...":t}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),console.log(this._getInputValues())}))}}const d=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResponse)}getAPIInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}updateProfileInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}deleteUserCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLikes(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLikes(e){return fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateProfileAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bc327ce1-4668-42e6-9a70-be158cef63f8","Content-Type":"application/json"}}),h=new o(i,document.querySelector(".modal__form")),u=new o(i,document.querySelector(".new-item-modal__form")),_=new o(i,document.querySelector(".change-avatar-form__form"));h.enableValidation(),u.enableValidation(),_.enableValidation();const m=new class extends l{constructor(e){super({popupSelector:e})}open(e,t){this._image=this._popupElement.querySelector(".image-pop-up__image"),this._imagePopUpTitle=this._popupElement.querySelector(".image-pop-up__title"),this._imagePopUpTitle.textContent=e,this._image.src=t,this._image.alt=e,super.open()}}(r.previewPopup,(function(e,t){m.open(e,t)}));m.setEventListeners();const p=new class{constructor(e){let{nameSelector:t,descriptionSelector:s,userAvatar:r}=e;this._nameElement=document.querySelector(t),this._descriptionElement=document.querySelector(s),this._userAvatar=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,about:this._descriptionElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=s}setAvatar(e){console.log(e),this._userAvatar.textContent=e.name,this._userAvatar.src=e}getAvatar(){return this._userAvatar.src}}({nameSelector:".profile-info__name",descriptionSelector:".profile-info__subtitle",userAvatar:".profile__avatar"});console.log(document.querySelector(".profile-info__subtitle").textContent);const f=new class extends l{constructor(e){var t,s,r;super({popupSelector:e}),t=this,r=e=>{e.preventDefault(),this._handleConfirm()},(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(s="_handleSubmit"))in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,this._popupForm=this._popupElement.querySelector(".form"),this._confirmButton=this._popupForm.querySelector(".confirm-popup__button"),this._saveButton=this._popupForm.querySelector(".form__submit")}setSubmitAction(e){this._handleConfirm=e}renderLoading(e){this._saveButton.textContent=e?"Loading...":"Yes"}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}(".confirm-popup");let v,g;f.setEventListeners();const E=new c({popupSelector:r.profileModal,handleFormSubmit:e=>{E.renderLoading(!0),d.updateProfileInfo(e).then((e=>{console.log(e),p.setUserInfo(e),E.close()})).catch((e=>{console.log(e)})).finally((()=>{E.renderLoading(!1,"Save")}))}});function S(e){const t=new n(e,g,r.cardTemplate,((e,t)=>{m.open(e,t)}),(e=>{f.open(),f.setSubmitAction((()=>{f.renderLoading(!0),d.deleteUserCard(e).then((()=>{t.deleteCard(),f.close()})).catch((e=>{console.log(e)})).finally((()=>{f.renderLoading(!1)}))}))}),(e=>{t.isLiked()?d.removeCardLikes(e).then((e=>{t.updateLikes(e.likes)})).catch((e=>{console.log(e)})):d.addCardLikes(e).then((e=>{t.updateLikes(e.likes)})).catch((e=>{console.log(e)}))}));return t}E.setEventListeners(),d.getAPIInfo().then((e=>{let[t,s]=e;console.log(t),g=t._id,p.setUserInfo(t),p.setAvatar(t.avatar),v=new a({items:s,renderer:e=>{const t=S(e);v.addItem(t.getView())}},r.cardSection),v.renderItems()})).catch((e=>{console.log(e)}));const b=new c({popupSelector:r.addCardModal,handleFormSubmit:e=>{b.renderLoading(!0),d.addNewCard(e).then((e=>{const t=S(e);b.close(),v.addItem(t.getView())})).catch((e=>{console.log(e)})).finally((()=>{b.renderLoading(!1,"Create")}))}});b.setEventListeners(),s.addEventListener("click",(function(){_.resetValidation(),L.open()}));const L=new c({popupSelector:r.changeAvatarForm,handleFormSubmit:e=>{console.log(e),L.renderLoading(!0),d.updateProfileAvatar(e.avatar).then((e=>{p.setAvatar(e.avatar),L.close()})).catch((e=>{console.log(e)})).finally((()=>{L.renderLoading(!1,"save")}))}});L.setEventListeners(),e.addEventListener("click",(function(){const e=p.getUserInfo();h.resetValidation(),E.setInputValues(e),E.open()})),t.addEventListener("click",(function(){u.resetValidation(),b.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVLElBRXZDeUksT0FBT0MsSUFDTmxILFFBQVFDLElBQUlpSCxFQUFJLElBRWpCQyxTQUFRLEtBQ1BRLEVBQWEvRSxlQUFjLEVBQU8sU0FBUyxHQUMzQyxJQUlSK0UsRUFBYXpGLG9CQUVidkgsRUFBYTRDLGlCQUFpQixTQUFTLFdBQ3JDbUksRUFBcUIvRSxrQkFDckJrSCxFQUFZL0YsTUFDZCxJQUVBLE1BQU0rRixFQUFjLElBQUl4RixFQUFjLENBQ3BDWCxjQUFlOUcsRUFBVU0saUJBQ3pCb0gsaUJBQW1CMEUsSUFDakJoSCxRQUFRQyxJQUFJK0csR0FDWmEsRUFBWWpGLGVBQWMsR0FDMUJTLEVBQ0crQixvQkFBb0I0QixFQUFPM0IsUUFDM0JqQixNQUFNeEksSUFDTGtLLEVBQVNRLFVBQVUxSyxFQUFLeUosUUFDeEJ3QyxFQUFZOUYsT0FBTyxJQUVwQmtGLE9BQU9DLElBQ05sSCxRQUFRQyxJQUFJaUgsRUFBSSxJQUVqQkMsU0FBUSxLQUNQVSxFQUFZakYsZUFBYyxFQUFPLE9BQU8sR0FDeEMsSUFJUmlGLEVBQVkzRixvQkFFWjNILEVBQVdnRCxpQkFBaUIsU0FBUyxXQUNuQyxNQUFNdUssRUFBT2hDLEVBQVM3QixjQUN0QnNCLEVBQWtCNUUsa0JBQ2xCb0csRUFBd0IzRCxlQUFlMEUsR0FDdkNmLEVBQXdCakYsTUFDMUIsSUFFQXBILEVBQVU2QyxpQkFBaUIsU0FBUyxXQUNsQ2tJLEVBQWlCOUUsa0JBQ2pCZ0gsRUFBYTdGLE1BQ2YsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZS1pbmZvX19lZGl0LWJ1dHRvblwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZS1pbmZvX19uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVN1YnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlLWluZm9fX3N1YnRpdGxlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX25hbWVcIik7XHJcbmV4cG9ydCBjb25zdCBpbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVzY3JpcHRpb25cIik7XHJcblxyXG5leHBvcnQgY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWhvdmVyLWJ1dHRvblwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xyXG4gIGNhcmRTZWN0aW9uOiBcIi5nYWxsZXJ5X19jYXJkc1wiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIuY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIHByZXZpZXdQb3B1cDogXCIuaW1hZ2UtcG9wLXVwXCIsXHJcbiAgcHJvZmlsZU1vZGFsOiBcIi5wcm9maWxlLW1vZGFsXCIsXHJcbiAgYWRkQ2FyZE1vZGFsOiBcIi5uZXctaXRlbS1tb2RhbFwiLFxyXG4gIGNoYW5nZUF2YXRhckZvcm06IFwiLmNoYW5nZS1hdmF0YXItZm9ybVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybUlucHV0VHlwZUVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGZvcm1JbnB1dEVycm9yQWN0aXZlQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbiAgZm9ybUlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgZm9ybVN1Ym1pdFNlbGVjdG9yOiBcIi5mb3JtX19zdWJtaXRcIixcclxuICBmb3JtU3VibWl0SW5hY3RpdmVDbGFzczogXCJmb3JtX19zdWJtaXRfaW5hY3RpdmVcIixcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXHJcbiAgICBsb2FkaW5nTGlrZUNoZWNrXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgdGhpcy5fbG9hZGluZ0xpa2VDaGVjayA9IGxvYWRpbmdMaWtlQ2hlY2s7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl91c2VyQ2FyZE93bmVySWQgPSBkYXRhW1wib3duZXJcIl0uX2lkO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0Q2FyZEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzLl9pZCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVJbWFnZUNsaWNrKCkge1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMaWtlcygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW1hZ2VNb2RhbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2UtcG9wLXVwXCIpO1xyXG5cclxuICAgIHRoaXMuX2NhcmRMaWtlcyA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fY291bnRlclwiKTtcclxuICAgIHRoaXMucmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICBpZiAodGhpcy5fdXNlcklkICE9IHRoaXMuX3VzZXJDYXJkT3duZXJJZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldENhcmRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtQ29uZmlnLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGZvcm1Db25maWcuZm9ybUlucHV0U2VsZWN0b3I7IC8vIC5mb3JtX19pbnB1dFxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBmb3JtQ29uZmlnLmZvcm1TdWJtaXRTZWxlY3RvcjsgLy8gLmZvcm1fX3N1Ym1pdFxyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGZvcm1Db25maWcuZm9ybVN1Ym1pdEluYWN0aXZlQ2xhc3M7IC8vIGZvcm1fX3N1Ym1pdF9pbmFjdGl2ZVxyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gZm9ybUNvbmZpZy5mb3JtSW5wdXRUeXBlRXJyb3JDbGFzczsgLy8gZm9ybV9faW5wdXRfdHlwZV9lcnJvclxyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGZvcm1Db25maWcuZm9ybUlucHV0RXJyb3JBY3RpdmVDbGFzczsgLy8gZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlXHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhpbnB1dEVsZW1lbnQpO1xyXG4gICAgY29uc29sZS5sb2coaW5wdXRFbGVtZW50LmlkKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX2Zvcm0pO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgLy8gICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIC8vICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgLy8gfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxlbWVudHMuc29tZShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgLy8gdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyLCBpdGVtcyB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xyXG5cclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAvLyB1c2UgdGhpcy5fcmVuZGVyZXIgdG8gY3JlYXRlIHRoZSBlbGVtZW50cyBmb3IgcmVuZGVyaW5nXHJcblxyXG4gICAgdGhpcy5faW5pdGlhbEFycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgLy8gdGFrZSB0aGUgaXRlbSBhbmQgcmVuZGVyIGl0IGludG8gdGhpcy5fZWxlbWVudFxyXG5cclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NVcCA9IHRoaXMuX2hhbmRsZUVzY1VwLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fb3BlblwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NVcCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjVXApO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY1VwKGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjbG9zZS1pY29uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0XCIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIHNhdmVCdXR0b25UZXh0KSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IHNhdmVCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIC8vIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIHNlbGVjdG9ycyxcclxuICBmb3JtQ29uZmlnLFxyXG4gIGVkaXRCdXR0b24sXHJcbiAgYWRkQnV0dG9uLFxyXG4gIGF2YXRhckJ1dHRvbixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL2FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiYzMyN2NlMS00NjY4LTQyZTYtOWE3MC1iZTE1OGNlZjYzZjhcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtQ29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIilcclxuKTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1Db25maWcsXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5uZXctaXRlbS1tb2RhbF9fZm9ybVwiKVxyXG4pO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBmb3JtQ29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hhbmdlLWF2YXRhci1mb3JtX19mb3JtXCIpXHJcbik7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdQb3B1cCwgaGFuZGxlSW1hZ2VDbGljayk7XHJcblxyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlLWluZm9fX25hbWVcIixcclxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlLWluZm9fX3N1YnRpdGxlXCIsXHJcbiAgdXNlckF2YXRhcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5cclxuY29uc29sZS5sb2coZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlLWluZm9fX3N1YnRpdGxlXCIpLnRleHRDb250ZW50KTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIuY29uZmlybS1wb3B1cFwiKTtcclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IGVkaXRVc2VyUHJvZmlsZU1vZGFsTmV3ID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5wcm9maWxlTW9kYWwsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKHZhbHVlcykgPT4ge1xyXG4gICAgZWRpdFVzZXJQcm9maWxlTW9kYWxOZXcucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAudXBkYXRlUHJvZmlsZUluZm8odmFsdWVzKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgICAgIGVkaXRVc2VyUHJvZmlsZU1vZGFsTmV3LmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGVkaXRVc2VyUHJvZmlsZU1vZGFsTmV3LnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiU2F2ZVwiKTtcclxuICAgICAgfSk7XHJcbiAgfSxcclxufSk7XHJcblxyXG5lZGl0VXNlclByb2ZpbGVNb2RhbE5ldy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZSxcclxuICAgIChjYXJkTmFtZSwgY2FyZExpbmspID0+IHtcclxuICAgICAgaW1hZ2VQb3B1cC5vcGVuKGNhcmROYW1lLCBjYXJkTGluayk7XHJcbiAgICB9LFxyXG5cclxuICAgIChjYXJkSWQpID0+IHtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGVsZXRlVXNlckNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5yZW1vdmVDYXJkTGlrZXMoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmFkZENhcmRMaWtlcyhjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICApO1xyXG4gIHJldHVybiBjYXJkO1xyXG59XHJcblxyXG5hcGlcclxuICAuZ2V0QVBJSW5mbygpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgdXNlckNhcmRzXSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2codXNlckRhdGEpO1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgdXNlckluZm8uc2V0QXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IHVzZXJDYXJkcyxcclxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQuZ2V0VmlldygpKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgfSk7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmFkZENhcmRNb2RhbCxcclxuICBoYW5kbGVGb3JtU3VibWl0OiAodmFsdWVzKSA9PiB7XHJcbiAgICBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgIGFwaVxyXG4gICAgICAuYWRkTmV3Q2FyZCh2YWx1ZXMpXHJcbiAgICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFkZENhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGFkZENhcmQuZ2V0VmlldygpKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiQ3JlYXRlXCIpO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG59KTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRpb24ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5jaGFuZ2VBdmF0YXJGb3JtLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICh2YWx1ZXMpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7XHJcbiAgICBhdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgYXBpXHJcbiAgICAgIC51cGRhdGVQcm9maWxlQXZhdGFyKHZhbHVlcy5hdmF0YXIpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGRhdGEuYXZhdGFyKTtcclxuICAgICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBhdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlLCBcInNhdmVcIik7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBjb25zdCBpbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBlZGl0VXNlclByb2ZpbGVNb2RhbE5ldy5zZXRJbnB1dFZhbHVlcyhpbmZvKTtcclxuICBlZGl0VXNlclByb2ZpbGVNb2RhbE5ldy5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QVBJSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlSW5mbyh1c2VyRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVVc2VyQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkTGlrZXMoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZExpa2VzKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVByb2ZpbGVBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3AtdXBfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VQb3BVcFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmltYWdlLXBvcC11cF9fdGl0bGVcIlxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9pbWFnZVBvcFVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciwgdXNlckF2YXRhciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcih2YWx1ZSkge1xyXG4gICAgY29uc29sZS5sb2codmFsdWUpO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhci50ZXh0Q29udGVudCA9IHZhbHVlLm5hbWU7XHJcbiAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXZhdGFyKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3VzZXJBdmF0YXIuc3JjO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5jb25maXJtLXBvcHVwX19idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXRcIik7XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDb25maXJtID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiTG9hZGluZy4uLlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlU3VibWl0ID0gKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0oKTtcclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsInNlbGVjdG9ycyIsImNhcmRTZWN0aW9uIiwiY2FyZFRlbXBsYXRlIiwicHJldmlld1BvcHVwIiwicHJvZmlsZU1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwiY2hhbmdlQXZhdGFyRm9ybSIsImZvcm1Db25maWciLCJmb3JtSW5wdXRUeXBlRXJyb3JDbGFzcyIsImZvcm1JbnB1dEVycm9yQWN0aXZlQ2xhc3MiLCJmb3JtSW5wdXRTZWxlY3RvciIsImZvcm1TdWJtaXRTZWxlY3RvciIsImZvcm1TdWJtaXRJbmFjdGl2ZUNsYXNzIiwiZm9ybVNlbGVjdG9yIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibG9hZGluZ0xpa2VDaGVjayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfbGlrZXMiLCJsaWtlcyIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9sb2FkaW5nTGlrZUNoZWNrIiwiX3VzZXJJZCIsIl91c2VyQ2FyZE93bmVySWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwic2V0Q2FyZEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRJbWFnZSIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2RlbGV0ZUJ1dHRvbiIsImRlbGV0ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJ1cGRhdGVMaWtlcyIsInJlbmRlckxpa2VzIiwiX2NhcmRMaWtlcyIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiaXNMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInNvbWUiLCJsaWtlIiwiZ2V0VmlldyIsInNyYyIsImFsdCIsIl9pbWFnZU1vZGFsIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm0iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfaW5wdXRFbGVtZW50cyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJjb25zb2xlIiwibG9nIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiaXRlbXMiLCJfcmVuZGVyZXIiLCJfaW5pdGlhbEFycmF5IiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjVXAiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsIl9zYXZlQnV0dG9uIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInNhdmVCdXR0b25UZXh0IiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRBUElJbmZvIiwiYWxsIiwidXBkYXRlUHJvZmlsZUluZm8iLCJ1c2VyRGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwiX3JlZjIiLCJkZWxldGVVc2VyQ2FyZCIsImNhcmRJZCIsImFkZENhcmRMaWtlcyIsInJlbW92ZUNhcmRMaWtlcyIsInVwZGF0ZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0aW9uIiwiaW1hZ2VQb3B1cCIsIl9pbWFnZSIsIl9pbWFnZVBvcFVwVGl0bGUiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJ1c2VyQXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsIl91c2VyQXZhdGFyIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJnZXRBdmF0YXIiLCJkZWxldGVDYXJkUG9wdXAiLCJlIiwiX2hhbmRsZUNvbmZpcm0iLCJfY29uZmlybUJ1dHRvbiIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJlZGl0VXNlclByb2ZpbGVNb2RhbE5ldyIsInZhbHVlcyIsImNhdGNoIiwiZXJyIiwiZmluYWxseSIsImNyZWF0ZUNhcmQiLCJjYXJkRGF0YSIsImNhcmQiLCJjYXJkTmFtZSIsImNhcmRMaW5rIiwidXNlckNhcmRzIiwibmV3Q2FyZCIsImFkZENhcmRQb3B1cCIsImFkZENhcmQiLCJhdmF0YXJQb3B1cCIsImluZm8iXSwic291cmNlUm9vdCI6IiJ9